{% comment %}
  USAGE: {% render 'initialize-custom-fonts', font_name: 'Font Name' %}
{% endcomment %}

{%- liquid
assign font_1 =  'Trade Gothic'         | append: ':' | append: 'TradeGothicLTStd-Extended.woff2' | asset_url
assign font_2 =  'Trade Gothic Bold'    | append: ':' | append: 'TradeGothicLTStd-BoldExt.woff2'  | asset_url
assign font_3 =  'Dahlia Bold'          | append: ':' | append: 'Dahlia-BoldCondensed.woff2'      | asset_url
assign font_4 =  'Dahlia Medium'        | append: ':' | append: 'Dahlia-Medium.woff2'             | asset_url

capture fonts
  echo font_1 | append: ','
  echo font_2 | append: ','
  echo font_3 | append: ','
  echo font_4
endcapture
-%}

{% liquid
  assign swap        = 'font-display: swap;'
  assign font_exists = false
  assign font_list   = fonts | split: ','
  assign font_index  = 0

  for font in font_list
    if font contains font_name
      assign font_index   = forloop.index0
      assign font_exists  = true
    endif
  endfor

  if font_exists == true
    capture render_font
      assign font_src     = font_list[font_index] | split: ':' | last
      assign font_format  = 'format("woff2")'
      assign font_url     = 'url("'  | append: font_src | append: '") '
      assign src          = font_url | append: font_format

      echo '@font-face {'
        echo 'font-family'  | append: ':' | append: font      | append: ';'
        echo 'src'          | append: ':' | append: src       | append: ';'
        echo swap
      echo '}'
    endcapture

    echo '<style data-test>' | append: render_font | append: '</style>'
  endif
%}